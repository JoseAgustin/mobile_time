<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mobile time grid: movile_time_grid.F90 Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mobile time grid
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">Creates grid with mobile activity data</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">movile_time_grid.F90</div>  </div>
</div><!--header-->
<div class="contents">
<a href="movile__time__grid_8_f90.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">!     program movile_time_grid.F90</span></div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html">   23</a></span>&#160;<span class="keyword">module</span> <a class="code" href="namespacegrid__temp__mod.html">grid_temp_mod</a></div>
<div class="line"><a name="l00025"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">   25</a></span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">parameter</span> :: <a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a>=952</div>
<div class="line"><a name="l00027"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">   27</a></span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">parameter</span> :: <a class="code" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">n_rows</a>=75889</div>
<div class="line"><a name="l00029"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">   29</a></span>&#160;<span class="keywordtype">integer</span>,<span class="keywordtype">parameter</span> :: <a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>=11848</div>
<div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a85aacfe4ef40a8a631570fb07b84ce56">   31</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#a85aacfe4ef40a8a631570fb07b84ce56">idcell</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a9763488a29bfbd0b4320f774d1ac2212">   33</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#a9763488a29bfbd0b4320f774d1ac2212">igeo</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00035"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#aa6ae270eb1c509902f7f7a3356d0b46d">   35</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#aa6ae270eb1c509902f7f7a3356d0b46d">idsrc</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a938354ffb8ddf9cf2836f8ddf01aeac9">   37</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#a938354ffb8ddf9cf2836f8ddf01aeac9">isrc</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a7c87fa14ce663193ee6bf8b7b55ef709">   39</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#a7c87fa14ce663193ee6bf8b7b55ef709">grid_id</a>(<a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a>)</div>
<div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a6a2d0e9e9ffa76a61731c7eabc278620">   41</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#a6a2d0e9e9ffa76a61731c7eabc278620">id_time_period</a>(<a class="code" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">n_rows</a>)</div>
<div class="line"><a name="l00043"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#ab56f6bde9b29a57298b5efcd794a97bf">   43</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#ab56f6bde9b29a57298b5efcd794a97bf">itype</a>(<a class="code" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">n_rows</a>)</div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#abcbd0c0379deeaa1fd8f1a155bc36e2f">   45</a></span>&#160;<span class="keywordtype">integer</span> :: <a class="code" href="namespacegrid__temp__mod.html#abcbd0c0379deeaa1fd8f1a155bc36e2f">isource</a>(<a class="code" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">n_rows</a>)</div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a4472c0e0d6d8821129698b57b70aa67b">   47</a></span>&#160;<span class="keywordtype">real</span>,<span class="keywordtype">dimension(24,n_rows)</span> :: <a class="code" href="namespacegrid__temp__mod.html#a4472c0e0d6d8821129698b57b70aa67b">autn</a></div>
<div class="line"><a name="l00049"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a66f639cf3d5d50e0ff11b074c6044549">   49</a></span>&#160;<span class="keywordtype">real</span>,<span class="keywordtype">dimension(24,n_grid)</span> :: <a class="code" href="namespacegrid__temp__mod.html#a66f639cf3d5d50e0ff11b074c6044549">activity</a></div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a5e46d0eb71bcd19215145433c1e6535c">   51</a></span>&#160;<span class="keywordtype">real</span> :: <a class="code" href="namespacegrid__temp__mod.html#a5e46d0eb71bcd19215145433c1e6535c">long</a>(<a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a>)</div>
<div class="line"><a name="l00053"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a9b855bf83cdcdec814b2b987c0f3e867">   53</a></span>&#160;<span class="keywordtype">real</span> :: <a class="code" href="namespacegrid__temp__mod.html#a9b855bf83cdcdec814b2b987c0f3e867">lat</a>(<a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a>)</div>
<div class="line"><a name="l00055"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a8f3e2048bf362cb7debc704365bd38e9">   55</a></span>&#160;<span class="keywordtype">real</span> :: <a class="code" href="namespacegrid__temp__mod.html#a8f3e2048bf362cb7debc704365bd38e9">cutla</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#af37ddb943137368e3ce3dc09f470714b">   57</a></span>&#160;<span class="keywordtype">real</span> :: <a class="code" href="namespacegrid__temp__mod.html#af37ddb943137368e3ce3dc09f470714b">cw</a>(<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a>)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;<span class="keyword">common</span> /intersec/ <a class="code" href="namespacegrid__temp__mod.html#a8f3e2048bf362cb7debc704365bd38e9">cutla</a>,<a class="code" href="namespacegrid__temp__mod.html#af37ddb943137368e3ce3dc09f470714b">cw</a>,<a class="code" href="namespacegrid__temp__mod.html#a85aacfe4ef40a8a631570fb07b84ce56">idcell</a>,<a class="code" href="namespacegrid__temp__mod.html#aa6ae270eb1c509902f7f7a3356d0b46d">idsrc</a>,<a class="code" href="namespacegrid__temp__mod.html#a9763488a29bfbd0b4320f774d1ac2212">igeo</a>,<a class="code" href="namespacegrid__temp__mod.html#a938354ffb8ddf9cf2836f8ddf01aeac9">isrc</a></div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keyword">common</span> /cellattr/ <a class="code" href="namespacegrid__temp__mod.html#a7c87fa14ce663193ee6bf8b7b55ef709">grid_id</a>,<a class="code" href="namespacegrid__temp__mod.html#a5e46d0eb71bcd19215145433c1e6535c">long</a>,<a class="code" href="namespacegrid__temp__mod.html#a9b855bf83cdcdec814b2b987c0f3e867">lat</a></div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;<span class="keyword">common</span> /srctd/ <a class="code" href="namespacegrid__temp__mod.html#a4472c0e0d6d8821129698b57b70aa67b">autn</a>, <a class="code" href="namespacegrid__temp__mod.html#abcbd0c0379deeaa1fd8f1a155bc36e2f">isource</a>, <a class="code" href="namespacegrid__temp__mod.html#a6a2d0e9e9ffa76a61731c7eabc278620">id_time_period</a>,<a class="code" href="namespacegrid__temp__mod.html#ab56f6bde9b29a57298b5efcd794a97bf">itype</a></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160; </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;<span class="keyword">contains</span></div>
<div class="line"><a name="l00073"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a58159ec25bd3923a5e93e91a6627edf0">   73</a></span>&#160;  <span class="keyword">subroutine  </span><a class="code" href="namespacegrid__temp__mod.html#a58159ec25bd3923a5e93e91a6627edf0">utm_2_ll</a>(utmx,utmy,utmz,lat,long)</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;  <span class="keywordtype">integer</span>,<span class="keywordtype">intent (IN)</span>:: utmZ</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="keywordtype">  real</span>,<span class="keywordtype">intent (IN)</span>:: utmx,utmy</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;<span class="keywordtype">  real</span>,<span class="keywordtype">intent (OUT)</span> ::lat,long</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="keywordtype">  real</span>:: utmym,dlong,dlongp,dlongx</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="keywordtype">  real</span>::  DEGRAD,latx</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment">!     THIS SUBROUTINE CONVERTS from UTM coordinates</span></div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment">!</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keyword">DATA</span> degrad/0.017453/</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;  latx = utmy / 111.</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  dlongx = (utmx - 500.) / ((111.226 + 0.0053 * latx) * &amp;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   (cos(degrad * latx)))</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;      utmym = utmy - (3187. * sin(2. * degrad * latx) * &amp;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;      (1. -cos(degrad * dlongx)))</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      lat = (utmym - 2.41 - 0.00903 * latx * latx) / 110.270</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      dlongp = (utmx - 500.) / ((111.226 + 0.0053 * lat) * &amp;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    (cos(degrad * lat)))</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;      long = -(180 - (6 * utmz) + 3 - dlongp )</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;  <span class="keyword">end subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a58159ec25bd3923a5e93e91a6627edf0">utm_2_ll</a></div>
<div class="line"><a name="l00103"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a3033953d9ff67722c79705842971c457">  103</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a3033953d9ff67722c79705842971c457">lee_atributos</a></div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keywordtype">integer</span>:: iunit      <span class="comment">!  Unit ID for the cell_attr.txt file</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <span class="keywordtype">integer</span> :: i,idum</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;<span class="keywordtype">  real</span> :: utmx,utmy</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <span class="keyword">open</span>(newunit=iunit,file=<span class="stringliteral">&quot;data/cell_attr.txt&quot;</span>,action=<span class="stringliteral">&quot;READ&quot;</span>)</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">do</span> i=1,<a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <span class="keyword">read</span> (iunit,*)idum,<a class="code" href="namespacegrid__temp__mod.html#a7c87fa14ce663193ee6bf8b7b55ef709">grid_id</a>(i),utmx,utmy</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="keyword">call </span><a class="code" href="namespacegrid__temp__mod.html#a58159ec25bd3923a5e93e91a6627edf0">utm_2_ll</a>(utmx,utmy,14,<a class="code" href="namespacegrid__temp__mod.html#a9b855bf83cdcdec814b2b987c0f3e867">lat</a>(i),<a class="code" href="namespacegrid__temp__mod.html#a5e46d0eb71bcd19215145433c1e6535c">long</a>(i))</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <span class="keyword">close</span>(iunit)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  i=1</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <span class="comment">!write(6,*) grid_id(i),lat(i),long(i)</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  i=<a class="code" href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">n_grid</a></div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <span class="comment">!write(6,*) grid_id(i),lat(i),long(i)</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keyword">write</span>(6,*) <span class="stringliteral">&quot;Finish reading cell_attr.txt&quot;</span></div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a3033953d9ff67722c79705842971c457">lee_atributos</a></div>
<div class="line"><a name="l00125"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#afa7a8c03e37419efbd68210dc52afd8f">  125</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacegrid__temp__mod.html#afa7a8c03e37419efbd68210dc52afd8f">lee_actividades</a></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordtype">integer</span>:: iunit      <span class="comment">!  Unit ID for thesrc_td.txt file</span></div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <span class="keywordtype">integer</span> :: idum,i,j</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <span class="keyword">open</span>(newunit=iunit,file=<span class="stringliteral">&quot;data/src_td.txt&quot;</span>,action=<span class="stringliteral">&quot;READ&quot;</span>)</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <span class="keywordflow">do</span> j=1,<a class="code" href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">n_rows</a></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;  <span class="keyword">read</span> (iunit,*)idum,idum,idum,<a class="code" href="namespacegrid__temp__mod.html#abcbd0c0379deeaa1fd8f1a155bc36e2f">isource</a>(j),&amp;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <a class="code" href="namespacegrid__temp__mod.html#a6a2d0e9e9ffa76a61731c7eabc278620">id_time_period</a>(j),<a class="code" href="namespacegrid__temp__mod.html#ab56f6bde9b29a57298b5efcd794a97bf">itype</a>(j), &amp;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        idum,idum,(<a class="code" href="namespacegrid__temp__mod.html#a4472c0e0d6d8821129698b57b70aa67b">autn</a>(i,j),i=1,24)<span class="comment">!,(vel(i,j),i=1,24)</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keyword">close</span>(iunit)</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keyword">write</span>(6,*) <span class="stringliteral">&quot;Finish reading src_td.txt&quot;</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <span class="keyword">open</span>(newunit=iunit,file=<span class="stringliteral">&quot;data/intersection.txt&quot;</span>,action=<span class="stringliteral">&quot;READ&quot;</span>)</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordflow">do</span>  j=1,<a class="code" href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">nint</a></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="keyword">read</span>(iunit,*)idum,<a class="code" href="namespacegrid__temp__mod.html#a85aacfe4ef40a8a631570fb07b84ce56">idcell</a>(j),<a class="code" href="namespacegrid__temp__mod.html#a938354ffb8ddf9cf2836f8ddf01aeac9">isrc</a>(j),<a class="code" href="namespacegrid__temp__mod.html#a9763488a29bfbd0b4320f774d1ac2212">igeo</a>(j),<a class="code" href="namespacegrid__temp__mod.html#aa6ae270eb1c509902f7f7a3356d0b46d">idsrc</a>(j), &amp;</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;             <a class="code" href="namespacegrid__temp__mod.html#a8f3e2048bf362cb7debc704365bd38e9">cutla</a>(j),<a class="code" href="namespacegrid__temp__mod.html#af37ddb943137368e3ce3dc09f470714b">cw</a>(j)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="keywordflow">  end do</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keyword">write</span>(6,*) <span class="stringliteral">&quot;Finish reading intersection.txt&quot;</span></div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <span class="keyword">close</span>(iunit)</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160; </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacegrid__temp__mod.html#afa7a8c03e37419efbd68210dc52afd8f">lee_actividades</a></div>
<div class="line"><a name="l00151"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a8376d5fa8d301a411ef5ddfc7c0bd47c">  151</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a8376d5fa8d301a411ef5ddfc7c0bd47c">genera_malla</a></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keywordtype">implicit none</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a8376d5fa8d301a411ef5ddfc7c0bd47c">genera_malla</a></div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="namespacegrid__temp__mod.html#a936197e0bd97c3ff6ba5a612738d45cb">  160</a></span>&#160;<span class="keyword">subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a936197e0bd97c3ff6ba5a612738d45cb">guarda_malla</a></div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;<span class="keyword">end subroutine </span><a class="code" href="namespacegrid__temp__mod.html#a936197e0bd97c3ff6ba5a612738d45cb">guarda_malla</a></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160; </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;<span class="keyword">end module </span><a class="code" href="namespacegrid__temp__mod.html">grid_temp_mod</a></div>
<div class="line"><a name="l00170"></a><span class="lineno"><a class="line" href="movile__time__grid_8_f90.html#a07c7792a8f91ddec9c1a1cc4596bf7a6">  170</a></span>&#160;<span class="keyword">program</span> <a class="code" href="movile__time__grid_8_f90.html#a07c7792a8f91ddec9c1a1cc4596bf7a6">grid_movil_temp</a></div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="keywordtype">use </span><a class="code" href="namespacegrid__temp__mod.html">grid_temp_mod</a></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacegrid__temp__mod.html#a3033953d9ff67722c79705842971c457">lee_atributos</a></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacegrid__temp__mod.html#afa7a8c03e37419efbd68210dc52afd8f">lee_actividades</a></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacegrid__temp__mod.html#a8376d5fa8d301a411ef5ddfc7c0bd47c">genera_malla</a></div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="keyword">call </span><a class="code" href="namespacegrid__temp__mod.html#a936197e0bd97c3ff6ba5a612738d45cb">guarda_malla</a></div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="keyword">end program</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="anamespacegrid__temp__mod_html_a8376d5fa8d301a411ef5ddfc7c0bd47c"><div class="ttname"><a href="namespacegrid__temp__mod.html#a8376d5fa8d301a411ef5ddfc7c0bd47c">grid_temp_mod::genera_malla</a></div><div class="ttdeci">subroutine genera_malla</div><div class="ttdoc">Make a single grid code with vehicular activity.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00151">movile_time_grid.F90:152</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a58159ec25bd3923a5e93e91a6627edf0"><div class="ttname"><a href="namespacegrid__temp__mod.html#a58159ec25bd3923a5e93e91a6627edf0">grid_temp_mod::utm_2_ll</a></div><div class="ttdeci">subroutine utm_2_ll(utmx, utmy, utmz, lat, long)</div><div class="ttdoc">Program to convert UTM coordinates to lat lon.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00073">movile_time_grid.F90:74</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a7c87fa14ce663193ee6bf8b7b55ef709"><div class="ttname"><a href="namespacegrid__temp__mod.html#a7c87fa14ce663193ee6bf8b7b55ef709">grid_temp_mod::grid_id</a></div><div class="ttdeci">integer, dimension(n_grid) grid_id</div><div class="ttdoc">GRID ID from the used mesh.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00039">movile_time_grid.F90:39</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a4472c0e0d6d8821129698b57b70aa67b"><div class="ttname"><a href="namespacegrid__temp__mod.html#a4472c0e0d6d8821129698b57b70aa67b">grid_temp_mod::autn</a></div><div class="ttdeci">real, dimension(24, n_rows) autn</div><div class="ttdoc">Number of cars in a specifil viality and hour.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00047">movile_time_grid.F90:47</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a5e46d0eb71bcd19215145433c1e6535c"><div class="ttname"><a href="namespacegrid__temp__mod.html#a5e46d0eb71bcd19215145433c1e6535c">grid_temp_mod::long</a></div><div class="ttdeci">real, dimension(n_grid) long</div><div class="ttdoc">longitud coordinate for the mesh</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00051">movile_time_grid.F90:51</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a938354ffb8ddf9cf2836f8ddf01aeac9"><div class="ttname"><a href="namespacegrid__temp__mod.html#a938354ffb8ddf9cf2836f8ddf01aeac9">grid_temp_mod::isrc</a></div><div class="ttdeci">integer, dimension(nint) isrc</div><div class="ttdoc">GEOmetry ID for viality from intersection.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00037">movile_time_grid.F90:37</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_abcbd0c0379deeaa1fd8f1a155bc36e2f"><div class="ttname"><a href="namespacegrid__temp__mod.html#abcbd0c0379deeaa1fd8f1a155bc36e2f">grid_temp_mod::isource</a></div><div class="ttdeci">integer, dimension(n_rows) isource</div><div class="ttdoc">Viality ID from src_td.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00045">movile_time_grid.F90:45</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a936197e0bd97c3ff6ba5a612738d45cb"><div class="ttname"><a href="namespacegrid__temp__mod.html#a936197e0bd97c3ff6ba5a612738d45cb">grid_temp_mod::guarda_malla</a></div><div class="ttdeci">subroutine guarda_malla</div><div class="ttdoc">Stores the mesh in a file.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00160">movile_time_grid.F90:161</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a8f3e2048bf362cb7debc704365bd38e9"><div class="ttname"><a href="namespacegrid__temp__mod.html#a8f3e2048bf362cb7debc704365bd38e9">grid_temp_mod::cutla</a></div><div class="ttdeci">real, dimension(nint) cutla</div><div class="ttdoc">fraction</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00055">movile_time_grid.F90:55</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a9763488a29bfbd0b4320f774d1ac2212"><div class="ttname"><a href="namespacegrid__temp__mod.html#a9763488a29bfbd0b4320f774d1ac2212">grid_temp_mod::igeo</a></div><div class="ttdeci">integer, dimension(nint) igeo</div><div class="ttdoc">GEOmetry ID for viality from intersection.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00033">movile_time_grid.F90:33</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_aa6ae270eb1c509902f7f7a3356d0b46d"><div class="ttname"><a href="namespacegrid__temp__mod.html#aa6ae270eb1c509902f7f7a3356d0b46d">grid_temp_mod::idsrc</a></div><div class="ttdeci">integer, dimension(nint) idsrc</div><div class="ttdoc">GEOmetry ID for viality from intersection.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00035">movile_time_grid.F90:35</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_afa7a8c03e37419efbd68210dc52afd8f"><div class="ttname"><a href="namespacegrid__temp__mod.html#afa7a8c03e37419efbd68210dc52afd8f">grid_temp_mod::lee_actividades</a></div><div class="ttdeci">subroutine lee_actividades</div><div class="ttdoc">Reads for each grid the numbero fo vehicles per category by hour.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00125">movile_time_grid.F90:126</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_aaeba93359f7343eef758e03917ad01fc"><div class="ttname"><a href="namespacegrid__temp__mod.html#aaeba93359f7343eef758e03917ad01fc">grid_temp_mod::nint</a></div><div class="ttdeci">integer, parameter nint</div><div class="ttdoc">Number of viality segments.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00029">movile_time_grid.F90:29</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html"><div class="ttname"><a href="namespacegrid__temp__mod.html">grid_temp_mod</a></div><div class="ttdoc">Variables for the identification of temporal profiles in a grid.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00023">movile_time_grid.F90:23</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a0c37af1286393487b24d33d9adb3b31e"><div class="ttname"><a href="namespacegrid__temp__mod.html#a0c37af1286393487b24d33d9adb3b31e">grid_temp_mod::n_grid</a></div><div class="ttdeci">integer, parameter n_grid</div><div class="ttdoc">Number of grids in the mesh.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00025">movile_time_grid.F90:25</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a3033953d9ff67722c79705842971c457"><div class="ttname"><a href="namespacegrid__temp__mod.html#a3033953d9ff67722c79705842971c457">grid_temp_mod::lee_atributos</a></div><div class="ttdeci">subroutine lee_atributos</div><div class="ttdoc">Reads file grid cell attributes IDgrid, utmx, utmy.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00103">movile_time_grid.F90:104</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a85aacfe4ef40a8a631570fb07b84ce56"><div class="ttname"><a href="namespacegrid__temp__mod.html#a85aacfe4ef40a8a631570fb07b84ce56">grid_temp_mod::idcell</a></div><div class="ttdeci">integer, dimension(nint) idcell</div><div class="ttdoc">GRID ID from the used mesh from intersection.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00031">movile_time_grid.F90:31</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a9b855bf83cdcdec814b2b987c0f3e867"><div class="ttname"><a href="namespacegrid__temp__mod.html#a9b855bf83cdcdec814b2b987c0f3e867">grid_temp_mod::lat</a></div><div class="ttdeci">real, dimension(n_grid) lat</div><div class="ttdoc">latitude coordinate for the mesh</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00053">movile_time_grid.F90:53</a></div></div>
<div class="ttc" id="amovile__time__grid_8_f90_html_a07c7792a8f91ddec9c1a1cc4596bf7a6"><div class="ttname"><a href="movile__time__grid_8_f90.html#a07c7792a8f91ddec9c1a1cc4596bf7a6">grid_movil_temp</a></div><div class="ttdeci">program grid_movil_temp</div><div class="ttdoc">Program to obtain the temporal distribution over CDMX.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00170">movile_time_grid.F90:170</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a66f639cf3d5d50e0ff11b074c6044549"><div class="ttname"><a href="namespacegrid__temp__mod.html#a66f639cf3d5d50e0ff11b074c6044549">grid_temp_mod::activity</a></div><div class="ttdeci">real, dimension(24, n_grid) activity</div><div class="ttdoc">total number of vehicles per hour in each grid</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00049">movile_time_grid.F90:49</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_af37ddb943137368e3ce3dc09f470714b"><div class="ttname"><a href="namespacegrid__temp__mod.html#af37ddb943137368e3ce3dc09f470714b">grid_temp_mod::cw</a></div><div class="ttdeci">real, dimension(nint) cw</div><div class="ttdoc">fraction</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00057">movile_time_grid.F90:57</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_ab0f4f05425f3ce7e7148066fcbeea7aa"><div class="ttname"><a href="namespacegrid__temp__mod.html#ab0f4f05425f3ce7e7148066fcbeea7aa">grid_temp_mod::n_rows</a></div><div class="ttdeci">integer, parameter n_rows</div><div class="ttdoc">Number of rows in results data.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00027">movile_time_grid.F90:27</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_a6a2d0e9e9ffa76a61731c7eabc278620"><div class="ttname"><a href="namespacegrid__temp__mod.html#a6a2d0e9e9ffa76a61731c7eabc278620">grid_temp_mod::id_time_period</a></div><div class="ttdeci">integer, dimension(n_rows) id_time_period</div><div class="ttdoc">ID of period time.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00041">movile_time_grid.F90:41</a></div></div>
<div class="ttc" id="anamespacegrid__temp__mod_html_ab56f6bde9b29a57298b5efcd794a97bf"><div class="ttname"><a href="namespacegrid__temp__mod.html#ab56f6bde9b29a57298b5efcd794a97bf">grid_temp_mod::itype</a></div><div class="ttdeci">integer, dimension(n_rows) itype</div><div class="ttdoc">Source type.</div><div class="ttdef"><b>Definition:</b> <a href="movile__time__grid_8_f90_source.html#l00043">movile_time_grid.F90:43</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
